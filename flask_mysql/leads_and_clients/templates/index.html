<!DOCTYPE html>
<html lang="en">
    <head>
        <title></title>
        <meta charset="UTF-8">
        <!--line below is for bootstrap-->
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css">
    </head>
    <body>
        <form action="/new_date" method="POST">
            <input type="date" name="start">
            <input type="date" name="end">
            <input type="submit" name="submit" value="Update date range">
        </form>
        <h6>Leads generated by customer</h6>
        
        
        <table class="table">
            <tr>
                <th>Customer</th>
                <th>Number of leads</th>
            </tr>
           
            {% for item in data %}
                <tr>
                    <td>{{item['client']}}</td>
                    <td>{{item['COUNT(clients.client_id)']}}</td>
                </tr>
            {% endfor %}
        </table>


        <div id="chartContainer" style="height: 300px; width: 100%;"></div>
        <script src="https://canvasjs.com/assets/script/jquery-1.11.1.min.js"></script>
        <script src="https://canvasjs.com/assets/script/jquery.canvasjs.min.js"></script>
       
       <script>
            var options = {
            title: {
                text: "Customer leads"
            },
            animationEnabled: true,
            data: [{
                type: "pie",
                toolTipContent: "<b>{label}</b>: {y} leads",
/*                 showInLegend: "false",
                legendText: "{label}", */
                indexLabelFontSize: 12,
                indexLabel: "{label}",
                dataPoints: [
                    {%for item in data%}
                        { y: {{item['COUNT(clients.client_id)']}}, label:"{{item['client']}}" },
                    {% endfor %}
                ]
            }]
        };
        $("#chartContainer").CanvasJSChart(options);
        </script>
    </body>
</html>